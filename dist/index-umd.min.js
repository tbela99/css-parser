!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).CSSParser={})}(this,(function(e){"use strict";const t=92;function r(e){return"unit"in e&&["q","cap","ch","cm","cqb","cqh","cqi","cqmax","cqmin","cqw","dvb","dvh","dvi","dvmax","dvmin","dvw","em","ex","ic","in","lh","lvb","lvh","lvi","lvmax","lvw","mm","pc","pt","px","rem","rlh","svb","svh","svi","svmin","svw","vb","vh","vi","vmax","vmin","vw"].includes(e.unit.toLowerCase())}function n(e){return 95==e||function(e){return e>=97&&e<=122||e>=65&&e<=90}(e)||function(e){return e>=128}(e)}function a(e){return e>=48&&e<=57}function i(e){return 45==e||a(e)||n(e)}function o(e){const r=e.length-1;let a=0,o=e.charCodeAt(0);if(45==o){const r=e.charCodeAt(1);return null!=r&&(45==r||(r!=t||e.length>2&&!c(e.charCodeAt(2))))}if(!n(o))return!1;for(;a<r;)if(a+=o<128?1:String.fromCodePoint(o).length,o=e.charCodeAt(a),!i(o))return!1;return!0}function l(e){if(0==e.length)return!1;let t=e.charCodeAt(0),r=0;const n=e.length;for([43,45].includes(t)&&r++;r<n;){if(t=e.charCodeAt(r),!a(t)){if(46==t||69==t||101==t)break;return!1}r++}if(46==t&&!a(e.charCodeAt(++r)))return!1;for(;r<n;){if(t=e.charCodeAt(r),!a(t)){if(69==t||101==t){r++;break}return!1}r++}if(69==t||101==t){if(r==n)return!1;if(t=e.charCodeAt(r+1),[43,45].includes(t)&&r++,t=e.charCodeAt(r+1),!a(t))return!1}for(;++r<n;)if(t=e.charCodeAt(r),!a(t))return!1;return!0}function s(e){if("#"!=e.charAt(0)||![4,5,7,9].includes(e.length))return!1;for(let t of e.slice(1)){let e=t.charCodeAt(0);if(!(a(e)||e>=65&&e<=70||e>=97&&e<=102))return!1}return!0}function c(e){return 10==e||12==e||13==e}function d(e){return 9==e||32==e||c(e)}var h={properties:{inset:{shorthand:"inset",properties:["top","right","bottom","left"],types:["Length","Perc"],multiple:!1,separator:null,keywords:["auto"]},top:{shorthand:"inset"},right:{shorthand:"inset"},bottom:{shorthand:"inset"},left:{shorthand:"inset"},margin:{shorthand:"margin",properties:["margin-top","margin-right","margin-bottom","margin-left"],types:["Length","Perc"],multiple:!1,separator:null,keywords:["auto"]},"margin-top":{shorthand:"margin"},"margin-right":{shorthand:"margin"},"margin-bottom":{shorthand:"margin"},"margin-left":{shorthand:"margin"},padding:{shorthand:"padding",properties:["padding-top","padding-right","padding-bottom","padding-left"],types:["Length","Perc"],keywords:[]},"padding-top":{shorthand:"padding"},"padding-right":{shorthand:"padding"},"padding-bottom":{shorthand:"padding"},"padding-left":{shorthand:"padding"},"border-radius":{shorthand:"border-radius",properties:["border-top-left-radius","border-top-right-radius","border-bottom-right-radius","border-bottom-left-radius"],types:["Length","Perc"],multiple:!0,separator:"/",keywords:[]},"border-top-left-radius":{shorthand:"border-radius"},"border-top-right-radius":{shorthand:"border-radius"},"border-bottom-right-radius":{shorthand:"border-radius"},"border-bottom-left-radius":{shorthand:"border-radius"},"border-width":{shorthand:"border-width",properties:["border-top-width","border-right-width","border-bottom-width","border-left-width"],types:["Length","Perc"],keywords:["thin","medium","thick"]},"border-top-width":{shorthand:"border-width"},"border-right-width":{shorthand:"border-width"},"border-bottom-width":{shorthand:"border-width"},"border-left-width":{shorthand:"border-width"},"border-style":{shorthand:"border-style",properties:["border-top-style","border-right-style","border-bottom-style","border-left-style"],types:[],keywords:["none","hidden","dotted","dashed","solid","double","groove","ridge","inset","outset"]},"border-top-style":{shorthand:"border-style"},"border-right-style":{shorthand:"border-style"},"border-bottom-style":{shorthand:"border-style"},"border-left-style":{shorthand:"border-style"},"border-color":{shorthand:"border-color",properties:["border-top-color","border-right-color","border-bottom-color","border-left-color"],types:["Color"],keywords:[]},"border-top-color":{shorthand:"border-color"},"border-right-color":{shorthand:"border-color"},"border-bottom-color":{shorthand:"border-color"},"border-left-color":{shorthand:"border-color"}},map:{outline:{shorthand:"outline",pattern:"outline-color outline-style outline-width",keywords:["none"],default:["0","none"],properties:{"outline-color":{types:["Color"],default:["currentColor","invert"],keywords:["currentColor","invert"]},"outline-style":{types:[],default:["none"],keywords:["auto","none","dotted","dashed","solid","double","groove","ridge","inset","outset"]},"outline-width":{types:["Length","Perc"],default:["medium"],keywords:["thin","medium","thick"]}}},"outline-color":{shorthand:"outline"},"outline-style":{shorthand:"outline"},"outline-width":{shorthand:"outline"},font:{shorthand:"font",pattern:"font-weight font-style font-size line-height font-stretch font-variant font-family",keywords:["caption","icon","menu","message-box","small-caption","status-bar","-moz-window, ","-moz-document, ","-moz-desktop, ","-moz-info, ","-moz-dialog","-moz-button","-moz-pull-down-menu","-moz-list","-moz-field"],default:[],properties:{"font-weight":{types:["Number"],default:["normal","400"],keywords:["normal","bold","lighter","bolder"],constraints:{value:{min:"1",max:"1000"}},mapping:{thin:"100",hairline:"100","extra light":"200","ultra light":"200",light:"300",normal:"400",regular:"400",medium:"500","semi bold":"600","demi bold":"600",bold:"700","extra bold":"800","ultra bold":"800",black:"900",heavy:"900","extra black":"950","ultra black":"950"}},"font-style":{types:["Angle"],default:["normal"],keywords:["normal","italic","oblique"]},"font-size":{types:["Length","Perc"],default:[],keywords:["xx-small","x-small","small","medium","large","x-large","xx-large","xxx-large","larger","smaller"],required:!0},"line-height":{types:["Length","Perc","Number"],default:["normal"],keywords:["normal"],previous:"font-size",prefix:{typ:"Literal",val:"/"}},"font-stretch":{types:["Perc"],default:["normal"],keywords:["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],mapping:{"ultra-condensed":"50%","extra-condensed":"62.5%",condensed:"75%","semi-condensed":"87.5%",normal:"100%","semi-expanded":"112.5%",expanded:"125%","extra-expanded":"150%","ultra-expanded":"200%"}},"font-variant":{types:[],default:["normal"],keywords:["normal","none","common-ligatures","no-common-ligatures","discretionary-ligatures","no-discretionary-ligatures","historical-ligatures","no-historical-ligatures","contextual","no-contextual","historical-forms","small-caps","all-small-caps","petite-caps","all-petite-caps","unicase","titling-caps","ordinal","slashed-zero","lining-nums","oldstyle-nums","proportional-nums","tabular-nums","diagonal-fractions","stacked-fractions","ordinal","slashed-zero","ruby","jis78","jis83","jis90","jis04","simplified","traditional","full-width","proportional-width","ruby","sub","super","text","emoji","unicode"]},"font-family":{types:["String","Iden"],default:[],keywords:["serif","sans-serif","monospace","cursive","fantasy","system-ui","ui-serif","ui-sans-serif","ui-monospace","ui-rounded","math","emoji","fangsong"],required:!0,multiple:!0,separator:{typ:"Comma"}}}},"font-weight":{shorthand:"font"},"font-style":{shorthand:"font"},"font-size":{shorthand:"font"},"line-height":{shorthand:"font"},"font-stretch":{shorthand:"font"},"font-variant":{shorthand:"font"},"font-family":{shorthand:"font"},background:{shorthand:"background",pattern:"background-repeat background-color background-image background-attachment background-clip background-origin background-position background-size",keywords:["none"],default:[],multiple:!0,separator:{typ:"Comma"},properties:{"background-repeat":{types:[],default:["repeat"],multiple:!0,keywords:["repeat-x","repeat-y","repeat","space","round","no-repeat"],mapping:{"repeat no-repeat":"repeat-x","no-repeat repeat":"repeat-y","repeat repeat":"repeat","space space":"space","round round":"round","no-repeat no-repeat":"no-repeat"}},"background-color":{types:["Color"],default:["transparent"],keywords:[]},"background-image":{types:["UrlFunc"],default:["none"],keywords:["none"]},"background-attachment":{types:[],default:["scroll"],keywords:["scroll","fixed","local"]},"background-clip":{types:[],default:["border-box"],keywords:["border-box","padding-box","content-box","text"]},"background-origin":{types:[],default:["padding-box"],keywords:["border-box","padding-box","content-box"]},"background-position":{multiple:!0,types:["Perc","Length"],default:["0 0","top left","left top"],keywords:["top","left","center","bottom","right"],mapping:{left:"0",top:"0",center:"50%",bottom:"100%",right:"100%"},constraints:{mapping:{max:2}}},"background-size":{multiple:!0,previous:"background-position",prefix:{typ:"Literal",val:"/"},types:["Perc","Length"],default:["auto","auto auto"],keywords:["auto","cover","contain"],mapping:{"auto auto":"auto"}}}},"background-repeat":{shorthand:"background"},"background-color":{shorthand:"background"},"background-image":{shorthand:"background"},"background-attachment":{shorthand:"background"},"background-clip":{shorthand:"background"},"background-origin":{shorthand:"background"},"background-position":{shorthand:"background"},"background-size":{shorthand:"background"}}};const f=()=>h,u=Object.seal({aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgrey:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32",rebeccapurple:"#663399",transparent:"#00000000"}),p=Object.seal({"#f0f8ff":"aliceblue","#faebd7":"antiquewhite","#7fffd4":"aquamarine","#f0ffff":"azure","#f5f5dc":"beige","#ffe4c4":"bisque","#000000":"black","#ffebcd":"blanchedalmond","#0000ff":"blue","#8a2be2":"blueviolet","#a52a2a":"brown","#deb887":"burlywood","#5f9ea0":"cadetblue","#7fff00":"chartreuse","#d2691e":"chocolate","#ff7f50":"coral","#6495ed":"cornflowerblue","#fff8dc":"cornsilk","#dc143c":"crimson","#00ffff":"cyan","#00008b":"darkblue","#008b8b":"darkcyan","#b8860b":"darkgoldenrod","#a9a9a9":"darkgrey","#006400":"darkgreen","#bdb76b":"darkkhaki","#8b008b":"darkmagenta","#556b2f":"darkolivegreen","#ff8c00":"darkorange","#9932cc":"darkorchid","#8b0000":"darkred","#e9967a":"darksalmon","#8fbc8f":"darkseagreen","#483d8b":"darkslateblue","#2f4f4f":"darkslategrey","#00ced1":"darkturquoise","#9400d3":"darkviolet","#ff1493":"deeppink","#00bfff":"deepskyblue","#696969":"dimgrey","#1e90ff":"dodgerblue","#b22222":"firebrick","#fffaf0":"floralwhite","#228b22":"forestgreen","#dcdcdc":"gainsboro","#f8f8ff":"ghostwhite","#ffd700":"gold","#daa520":"goldenrod","#808080":"grey","#008000":"green","#adff2f":"greenyellow","#f0fff0":"honeydew","#ff69b4":"hotpink","#cd5c5c":"indianred","#4b0082":"indigo","#fffff0":"ivory","#f0e68c":"khaki","#e6e6fa":"lavender","#fff0f5":"lavenderblush","#7cfc00":"lawngreen","#fffacd":"lemonchiffon","#add8e6":"lightblue","#f08080":"lightcoral","#e0ffff":"lightcyan","#fafad2":"lightgoldenrodyellow","#d3d3d3":"lightgrey","#90ee90":"lightgreen","#ffb6c1":"lightpink","#ffa07a":"lightsalmon","#20b2aa":"lightseagreen","#87cefa":"lightskyblue","#778899":"lightslategrey","#b0c4de":"lightsteelblue","#ffffe0":"lightyellow","#00ff00":"lime","#32cd32":"limegreen","#faf0e6":"linen","#ff00ff":"magenta","#800000":"maroon","#66cdaa":"mediumaquamarine","#0000cd":"mediumblue","#ba55d3":"mediumorchid","#9370d8":"mediumpurple","#3cb371":"mediumseagreen","#7b68ee":"mediumslateblue","#00fa9a":"mediumspringgreen","#48d1cc":"mediumturquoise","#c71585":"mediumvioletred","#191970":"midnightblue","#f5fffa":"mintcream","#ffe4e1":"mistyrose","#ffe4b5":"moccasin","#ffdead":"navajowhite","#000080":"navy","#fdf5e6":"oldlace","#808000":"olive","#6b8e23":"olivedrab","#ffa500":"orange","#ff4500":"orangered","#da70d6":"orchid","#eee8aa":"palegoldenrod","#98fb98":"palegreen","#afeeee":"paleturquoise","#d87093":"palevioletred","#ffefd5":"papayawhip","#ffdab9":"peachpuff","#cd853f":"peru","#ffc0cb":"pink","#dda0dd":"plum","#b0e0e6":"powderblue","#800080":"purple","#ff0000":"red","#bc8f8f":"rosybrown","#4169e1":"royalblue","#8b4513":"saddlebrown","#fa8072":"salmon","#f4a460":"sandybrown","#2e8b57":"seagreen","#fff5ee":"seashell","#a0522d":"sienna","#c0c0c0":"silver","#87ceeb":"skyblue","#6a5acd":"slateblue","#708090":"slategrey","#fffafa":"snow","#00ff7f":"springgreen","#4682b4":"steelblue","#d2b48c":"tan","#008080":"teal","#d8bfd8":"thistle","#ff6347":"tomato","#40e0d0":"turquoise","#ee82ee":"violet","#f5deb3":"wheat","#ffffff":"white","#f5f5f5":"whitesmoke","#ffff00":"yellow","#9acd32":"yellowgreen","#663399":"rebeccapurple","#00000000":"transparent"});function g(e){if("Dimension"==e.typ)switch(e.unit){case"deg":return e.val/360;case"rad":return e.val/(2*Math.PI);case"grad":return e.val/400;case"turn":return+e.val}return e.val/360}function m(e,t,r,n=null){let a=r<=.5?r*(1+t):r+t-r*t,i=r,o=r,l=r;if(a>0){let t=r+r-a,n=(a-t)/a;e*=6;let s=Math.floor(e),c=a*n*(e-s),d=t+c,h=a-c;switch(s){case 0:i=a,o=d,l=t;break;case 1:i=h,o=a,l=t;break;case 2:i=t,o=a,l=d;break;case 3:i=t,o=h,l=a;break;case 4:i=d,o=t,l=a;break;case 5:i=a,o=t,l=h}}const s=[Math.round(255*i),Math.round(255*o),Math.round(255*l)];return null!=n&&1!=n&&s.push(Math.round(255*n)),s}const y=[];function b(e,t={}){const r=Object.assign(t.compress?{indent:"",newLine:"",preserveLicense:!1,removeComments:!0,colorConvert:!0}:{indent:" ",newLine:"\n",compress:!1,preserveLicense:!1,removeComments:!1,colorConvert:!0},t);return{code:v(e,r,(function(e,t,n,a){return"Comment"!=t.typ||!r.removeComments||r.preserveLicense&&t.val.startsWith("/*!")?r.compress&&"Whitespace"==t.typ&&("Start-parens"==a[n+1]?.typ||n>0&&("Pseudo-class-func"==a[n-1].typ||"End-parens"==a[n-1].typ||"UrlFunc"==a[n-1].typ||"Func"==a[n-1].typ||"Color"==a[n-1].typ&&"hex"!=a[n-1].kin&&"lit"!=a[n-1].kin))?e:e+k(t,r):e}))}}function v(e,t,r,n=0){y.length<n+1&&y.push(t.indent.repeat(n)),y.length<n+2&&y.push(t.indent.repeat(n+1));const a=y[n],i=y[n+1];switch(e.typ){case"Comment":return t.removeComments?"":e.val;case"StyleSheet":return e.chi.reduce(((e,n)=>{const a=v(n,t,r);return""===a?e:""===e?a:`${e}${t.newLine}${a}`}),"");case"AtRule":case"Rule":if("AtRule"==e.typ&&!("chi"in e))return`${a}@${e.nam} ${e.val};`;let o=e.chi.reduce(((e,a)=>{let o;return o="Comment"==a.typ?t.removeComments?"":a.val:"Declaration"==a.typ?`${a.nam}:${t.indent}${a.val.reduce(r,"").trimEnd()};`:"AtRule"!=a.typ||"chi"in a?v(a,t,r,n+1):`@${a.nam} ${a.val};`,""===e?o:""===o?e:""!==o?`${e}${t.newLine}${i}${o}`:void 0}),"");return o.endsWith(";")&&(o=o.slice(0,-1)),"AtRule"==e.typ?`@${e.nam}${e.val?" "+e.val+t.indent:""}{${t.newLine}`+(""===o?"":i+o+t.newLine)+a+"}":e.sel+`${t.indent}{${t.newLine}`+(""===o?"":i+o+t.newLine)+a+"}"}return""}function k(e,t={}){switch(e.typ){case"Color":if(t.compress||t.colorConvert){let t="hex"==e.kin?e.val.toLowerCase():"";"rgb"==e.val||"rgba"==e.val?t=function(e){let t,r="#";for(let n=0;n<6;n+=2)t=e.chi[n],r+=Math.round("Perc"==t.typ?255*t.val/100:t.val).toString(16).padStart(2,"0");return 7==e.chi.length&&(t=e.chi[6],("Number"==t.typ&&t.val<1||"Perc"==t.typ&&t.val<100)&&(r+=Math.round(255*("Perc"==t.typ?t.val/100:t.val)).toString(16).padStart(2,"0"))),r}(e):"hsl"==e.val||"hsla"==e.val?t=function(e){let t,r=g(e.chi[0]);t=e.chi[2];let n="Perc"==t.typ?t.val/100:t.val;t=e.chi[4];let a="Perc"==t.typ?t.val/100:t.val,i=null;return 7==e.chi?.length&&(t=e.chi[6],("Perc"==t.typ&&t.val<100||"Number"==t.typ&&t.val<1)&&(i="Perc"==t.typ?t.val/100:t.val)),`#${m(r,n,a,i).reduce(((e,t)=>e+t.toString(16).padStart(2,"0")),"")}`}(e):"hwb"==e.val?t=function(e){let t,r=g(e.chi[0]);t=e.chi[2];let n="Perc"==t.typ?t.val/100:t.val;t=e.chi[4];let a="Perc"==t.typ?t.val/100:t.val,i=null;7==e.chi?.length&&(t=e.chi[6],("Perc"==t.typ&&t.val<100||"Number"==t.typ&&t.val<1)&&(i="Perc"==t.typ?t.val/100:t.val));const o=m(r,1,.5,i);let l;for(let e=0;e<3;e++)l=o[e]/255,l*=1-n-a,l+=n,o[e]=Math.round(255*l);return`#${o.reduce(((e,t)=>e+t.toString(16).padStart(2,"0")),"")}`}(e):"device-cmyk"==e.val&&(t=function(e){let t=e.chi[0];const r="Perc"==t.typ?t.val/100:t.val;t=e.chi[2];const n="Perc"==t.typ?t.val/100:t.val;t=e.chi[4];const a="Perc"==t.typ?t.val/100:t.val;t=e.chi[6];const i="Perc"==t.typ?t.val/100:t.val,o=[Math.round(255*(1-Math.min(1,r*(1-i)+i))),Math.round(255*(1-Math.min(1,n*(1-i)+i))),Math.round(255*(1-Math.min(1,a*(1-i)+i)))];return e.chi.length>=9&&(t=e.chi[8],o.push(Math.round(255*("Perc"==t.typ?t.val/100:t.val)))),`#${o.reduce(((e,t)=>e+t.toString(16).padStart(2,"0")),"")}`}(e));const r=p[t];if(""!==t)return 7==t.length?t[1]==t[2]&&t[3]==t[4]&&t[5]==t[6]&&(t=`#${t[1]}${t[3]}${t[5]}`):9==t.length&&t[1]==t[2]&&t[3]==t[4]&&t[5]==t[6]&&t[7]==t[8]&&(t=`#${t[1]}${t[3]}${t[5]}${t[7]}`),null!=r&&r.length<=t.length?r:t}if("hex"==e.kin||"lit"==e.kin)return e.val;case"Func":case"UrlFunc":case"Pseudo-class-func":return(t.compress&&"Pseudo-class-func"==e.typ&&"::"==e.val.slice(0,2)?e.val.slice(1):e.val)+"("+e.chi.reduce(((e,r)=>!t.removeComments||"Comment"!=r.typ||t.preserveLicense&&r.val.startsWith("/*!")?e+k(r,t):e),"")+")";case"Includes":return"~=";case"Dash-match":return"|=";case"Lt":return"<";case"Gt":return">";case"Start-parens":return"(";case"End-parens":return")";case"Attr-start":return"[";case"Attr-end":return"]";case"Whitespace":return" ";case"Colon":return":";case"Semi-colon":return";";case"Comma":return",";case"Important":return"!important";case"Attr":return"["+e.chi.reduce(((e,r)=>e+k(r,t)),"")+"]";case"Time":case"Frequency":case"Angle":case"Length":case"Dimension":const r=(+e.val).toString();if("0"===r)return"Time"==e.typ?"0s":"Frequency"==e.typ?"0Hz":"Resolution"==e.typ?"0x":"0";const n=r.charAt(0);if("-"==n){if("-0"==r.slice(0,2))return(2==r.length?"0":"-"+r.slice(2))+e.unit}else if("0"==n)return r.slice(1)+e.unit;return r+e.unit;case"Perc":return e.val+"%";case"Number":const a=(+e.val).toString();if(e.val.length<a.length)return e.val;if("0"===a.charAt(0)&&a.length>1)return a.slice(1);return"-0"==a.slice(0,2)?"-"+a.slice(2):a;case"Comment":if(t.removeComments)return"";case"Url-token":case"At-rule":case"Hash":case"Pseudo-class":case"Literal":case"String":case"Iden":case"Delim":return t.compress&&"Pseudo-class"==e.typ&&"::"==e.val.slice(0,2)?e.val.slice(1):e.val}throw new Error(`unexpected token ${JSON.stringify(e,null,1)}`)}function w(e,t){if("object"!=typeof e||"object"!=typeof t)return e===t;const r=Object.keys(e),n=Object.keys(t);return r.length==n.length&&r.every((r=>w(e[r],t[r])))}class C{config;declarations;constructor(e){this.config=e,this.declarations=new Map}add(e){if(e.nam==this.config.shorthand)this.declarations.clear(),this.declarations.set(e.nam,e);else{if(e.nam!=this.config.shorthand&&this.declarations.has(this.config.shorthand)){let t=!0,r=-1;const n=[];for(let e of this.declarations.get(this.config.shorthand).val)if(this.config.types.includes(e.typ)||"Number"==e.typ&&"0"==e.val&&(this.config.types.includes("Length")||this.config.types.includes("Angle")||this.config.types.includes("Dimension")))0==n.length&&(n.push([]),r++),n[r].push(e);else if("Whitespace"!=e.typ&&"Comment"!=e.typ){if("Iden"==e.typ&&this.config.keywords.includes(e.val)&&n[r].push(e),"Literal"==e.typ&&e.val==this.config.separator){n.push([]),r++;continue}t=!1;break}if(t&&n.length>0){this.declarations.delete(this.config.shorthand);for(const e of n)this.config.properties.forEach(((t,r)=>{for(this.declarations.has(t)||this.declarations.set(t,{typ:"Declaration",nam:t,val:[]});r>0&&r>=e.length;){if(!(r>1)){r=0;break}r%=2}const n=this.declarations.get(t).val;n.length>0&&n.push({typ:"Whitespace"}),n.push({...e[r]})}))}return this.declarations.set(e.nam,e),this}this.declarations.set(e.nam,e)}return this}[Symbol.iterator](){let e;const t=this.declarations;if(!(t.size<this.config.properties.length||this.config.properties.some(((e,r)=>!t.has(e)||r>0&&t.get(e).val.length!=t.get(this.config.properties[Math.floor(r/2)]).val.length)))){const t=[];this.config.properties.forEach((e=>{let r=0;for(const n of this.declarations.get(e).val)"Whitespace"!=n.typ&&(t.length==r&&t.push([]),t[r].push(n),r++)}));for(const e of t){let t=e.length;for(;t-- >1;){const n=e[t],a=e[1==t?0:t%2];if(n.val==a.val&&"0"==n.val&&("Number"==n.typ&&r(a)||"Number"==a.typ&&r(n)||r(a)||r(n)))e.splice(t,1);else{if(!w(n,a))break;e.splice(t,1)}}}return e=[{typ:"Declaration",nam:this.config.shorthand,val:t.reduce(((e,t)=>{if(t.length>1){const e=2*t.length-1;let r=1;for(;r<e;)t.splice(r,0,{typ:"Whitespace"}),r+=2}return e.length>0&&e.push({typ:"Literal",val:this.config.separator}),e.push(...t),e}),[])}][Symbol.iterator](),{next:()=>e.next()}}return e=t.values(),{next:()=>e.next()}}}function x(e,t){return!!("Iden"==e.typ&&t.keywords.includes(e.val)||t.types.includes(e.typ))||"Number"==e.typ&&"0"==e.val&&t.types.some((e=>"Length"==e||"Angle"==e))}function A(e){return"transparent"==e||"currentcolor"==e?{typ:"Color",val:e,kin:"lit"}:e.endsWith("%")?{typ:"Perc",val:e.slice(0,-1)}:{typ:l(e)?"Number":"Iden",val:e}}function S(e){return e.split(/\s/).map(A).reduce(((e,t)=>(e.length>0&&e.push({typ:"Whitespace"}),e.push(t),e)),[])}class P{config;declarations;requiredCount;pattern;constructor(e){const t=Object.values(e.properties);this.requiredCount=t.reduce(((e,t)=>t.required?++e:e),0)||t.length,this.config=e,this.declarations=new Map,this.pattern=e.pattern.split(/\s/)}add(e){if(e.nam==this.config.shorthand)this.declarations.clear(),this.declarations.set(e.nam,e);else{const t=this.config.separator;if(e.nam!=this.config.shorthand&&this.declarations.has(this.config.shorthand)){const e={},r=[];this.declarations.get(this.config.shorthand).val.slice().reduce(((e,r)=>null!=t&&t.typ==r.typ&&w(t,r)?(e.push([]),e):(e.at(-1).push(r),e)),[[]]).reduce(((t,n,a)=>(r.push(...this.pattern.reduce(((t,r)=>{const n=this.config.properties[r];for(let i=0;i<t.length;i++)if("Comment"!=t[i].typ&&"Whitespace"!=t[i].typ){if(x(t[i],n)){if("prefix"in n&&null!=n.previous&&!(n.previous in e))return t;if(r in e?a==e[r].length?e[r].push([t[i]]):e[r][a].push({typ:"Whitespace"},t[i]):e[r]=[[t[i]]],t.splice(i,1),i--,"prefix"in n&&t[i]?.typ==n.prefix.typ&&w(t[i],this.config.properties[r].prefix)&&(t.splice(i,1),i--),n.multiple)continue;return t}if(r in e&&e[r].length>a)return t}else t.splice(i,1),i--;if(r in e&&e[r].length>a)return t;if(n.default.length>0){const t=S(n.default[0]);r in e?a==e[r].length?(e[r].push([]),e[r][a].push(...t)):e[r][a].push({typ:"Whitespace"},...t):e[r]=[[...t]]}return t}),n)),r)),[]),0==r.length&&(this.declarations=Object.entries(e).reduce(((e,r)=>(e.set(r[0],{typ:"Declaration",nam:r[0],val:r[1].reduce(((e,r)=>(e.length>0&&e.push({...t}),e.push(...r),e)),[])}),e)),new Map))}this.declarations.set(e.nam,e)}return this}[Symbol.iterator](){let e=Object.keys(this.config.properties).reduce(((e,t)=>this.declarations.has(t)&&this.config.properties[t].required?++e:e),0);if(0==e&&(e=this.declarations.size),e<this.requiredCount)return this.declarations.values();let t=0;const r=this.config.separator,n={};if(Object.entries(this.config.properties).reduce(((e,a)=>{if(!this.declarations.has(a[0]))return a[1].required&&e.push(a[0]),e;let i=0;const o=this.config.properties[a[0]];for(const t of this.declarations.get(a[0]).val)if(null!=r&&r.typ==t.typ&&w(r,t))i++,n[a[0]].length==i&&n[a[0]].push([]);else if(!("Whitespace"==t.typ||"Comment"==t.typ||o.multiple&&null!=o.separator&&o.separator.typ==t.typ&&w(t,o.separator))){if(!x(t,a[1])){e.push(a[0]);break}a[0]in n||(n[a[0]]=[[]]),n[a[0]][i].push(t)}return 0==t&&(t=i),e}),[]).length>0||Object.values(n).every((e=>e.every((e=>e.length==t)))))return this.declarations.values();const a=Object.entries(n).reduce(((e,t)=>{const r=this.config.properties[t[0]];for(let n=0;n<t[1].length;n++){e.length==n&&e.push([]);let a=t[1][n].reduce(((e,t)=>(e.length>0&&e.push({typ:"Whitespace"}),e.push(t),e)),[]);if(!r.default.includes(t[1][n].reduce(((e,t)=>e+k(t)+" "),"").trimEnd())&&(a=a.filter((e=>"Whitespace"!=e.typ&&"Comment"!=e.typ&&!("Iden"==e.typ&&r.default.includes(e.val)))),a.length>0)){if("mapping"in r&&(!("constraints"in r)||!("max"in r.constraints)||a.length<=r.constraints.mapping.max)){let e=a.length;for(;e--;)"Iden"==a[e].typ&&a[e].val in r.mapping&&a.splice(e,1,...S(r.mapping[a[e].val]))}"prefix"in r?e[n].push({...r.prefix}):e[n].length>0&&e[n].push({typ:"Whitespace"}),e[n].push(...a.reduce(((e,t)=>(e.length>0&&e.push({...r.separator??{typ:"Whitespace"}}),e.push(t),e)),[]))}}return e}),[]).reduce(((e,t)=>(e.length>0&&e.push({...r}),0==t.length&&t.push(...this.config.default[0].split(/\s/).map(A).reduce(((e,t)=>(e.length>0&&e.push({typ:"Whitespace"}),e.push(t),e)),[])),e.push(...t),e)),[]);return[{typ:"Declaration",nam:this.config.shorthand,val:a}][Symbol.iterator]()}}const L=f();class W{declarations;constructor(){this.declarations=new Map}add(e){if("Declaration"!=e.typ)return this.declarations.set(Number(Math.random().toString().slice(2)).toString(36),e),this;const t=e.nam;if(t in L.properties){const r=L.properties[t].shorthand;return this.declarations.has(r)||this.declarations.set(r,new C(L.properties[r])),this.declarations.get(r).add(e),this}if(t in L.map){const r=L.map[t].shorthand;return this.declarations.has(r)||this.declarations.set(r,new P(L.map[r])),this.declarations.get(r).add(e),this}return this.declarations.set(t,e),this}[Symbol.iterator](){let e=this.declarations.values();const t=[];return{next(){let r=e.next();for(;r.done&&t.length>0||r.value instanceof C||r.value instanceof P;)(r.value instanceof C||r.value instanceof P)&&(t.unshift(e),e=r.value[Symbol.iterator](),r=e.next()),r.done&&t.length>0&&(e=t.shift(),r=e.next());return r}}}}const $=f();function q(e,t={},r=!1){if("chi"in e&&e.chi?.length>0){let n,a,i,o=0;for(;o<e.chi.length;o++)if("Comment"!=e.chi[o].typ&&(a=e.chi[o],"AtRule"!=a.typ||"font-face"!=a.nam))if("AtRule"!=a.typ||"all"!=a.val){if(null!=n&&"chi"in n&&"chi"in a){if(n.typ==a.typ){let l=!0,s=n.chi.length;for(;s-- >0;)if("Comment"!=n.chi[s].typ){l="Declaration"==n.chi[s].typ;break}if(l){if("Rule"==a.typ&&a.sel==n.sel||"AtRule"==a.typ&&a.val==n.val){a.chi.unshift(...n.chi),e.chi.splice(i,1),M(a)?j(a):q(a,t,r),o--,n=a,i=o;continue}if("Rule"==a.typ&&"Rule"==n?.typ){const r=F(n,a,t);null!=r&&(0==r.node1.chi.length?e.chi.splice(o,1):e.chi.splice(o,1,r.node1),0==r.node2.chi.length?e.chi.splice(i,1,r.result):e.chi.splice(i,1,r.result,r.node2))}}}r&&n!=a&&(M(n)?j(n):q(n,t,r))}n=a,i=o}else e.chi?.splice(o,1,...a.chi),o--;r&&null!=a&&"chi"in a&&(a.chi.some((e=>"Declaration"==e.typ))?j(a):q(a,t,r))}return e}function M(e){for(let t=0;t<e.chi?.length;t++)if("Comment"!=e.chi[t].typ)return"Declaration"==e.chi[t].typ;return!0}function j(e,t={}){if(!("chi"in e)||e.chi?.length<=1)return e;const r=e.chi.length;let n=0,a=new Map;for(;n<r;n++){const t=e.chi[n];if("Comment"!=t.typ){if("Declaration"!=t.typ)break;if(t.nam in $.map||t.nam in $.properties){const e=t.nam in $.map?$.map[t.nam].shorthand:$.properties[t.nam].shorthand;a.has(e)||a.set(e,new W),a.get(e).add(t)}else a.set(t.nam,t)}else a.set(t,t)}const i=[];for(let e of a.values())e instanceof W?i.push(...e):i.push(e);return e.chi=i.concat(e.chi?.slice(n)),e}function z(e){const t=[];let r="";for(let n=0;n<e.length;n++){let a=e.charAt(n);if(","!=a)if(r+=a,"\\"!=a)if('"'!=a&&"'"!=a)if("("!=a&&"["!=a);else{const t=a,i="("==a?")":"]";let o=1,l=n;for(;++l<e.length;)if(a=e.charAt(l),"\\"!=a){if(r+=a,a==t?o++:a==i&&o--,0==o)break}else r+=e.slice(l,l+2),l++;n=l}else{let t=n;for(;++t<e.length;)if(a=e.charAt(t),r+=a,"//"!=a){if(a==e.charAt(n))break}else r+=e.charAt(++t)}else r+=e.charAt(++n);else""!==r&&(t.push(r),r="")}return""!==r&&t.push(r),t}function F(e,t,r={}){let n=e,a=t,i=!1;if(n.chi.length>a.chi.length){const e=n;n=a,a=e,i=!0}let o=n.chi.length,l=a.chi.length;if(0==o||0==l)return null;n={...n,chi:n.chi.slice()},a={...a,chi:a.chi.slice()};const s=[];for(;o--;)if("Comment"!=n.chi[o].typ){if(l=a.chi.length,0==l)break;for(;l--;)if("Comment"!=a.chi[l].typ&&n.chi[o].nam==a.chi[l].nam&&w(n.chi[o],a.chi[l])){s.push(n.chi[o]),n.chi.splice(o,1),a.chi.splice(l,1);break}}const c=0==s.length?null:{...n,sel:[...new Set([...(e.raw||z(e.sel)).concat(t.raw||z(t.sel))])].join(),chi:s.reverse()};return null==c||[e,t].reduce(((e,t)=>0==t.chi.length?e:e+b(t,r).code.length),0)<=[n,a,c].reduce(((e,t)=>0==t.chi.length?e:e+b(t,r).code.length),0)?null:{result:c,node1:i?a:n,node2:a}}const D=["Start-parens","Func","UrlFunc","Pseudo-class-func"];function I(e,t={}){const i=[],s={src:"",location:!1,compress:!1,processImport:!1,removeEmpty:!0,...t};if(0==e.length)return null;let h=-1,f=1,u=0;const p=[],g=s.src,m=[],y={typ:"StyleSheet",chi:[]},b={ind:Math.max(h,0),lin:f,col:Math.max(u,1)};let v,w="",C=e.length,x=new Map,A=y;function S(e){if(""===e)throw new Error("empty string?");return":"==e?{typ:"Colon"}:")"==e?{typ:"End-parens"}:"("==e?{typ:"Start-parens"}:"="==e?{typ:"Delim",val:e}:";"==e?{typ:"Semi-colon"}:","==e?{typ:"Comma"}:"<"==e?{typ:"Lt"}:">"==e?{typ:"Gt"}:":"==(t=e).charAt(0)&&(t.endsWith("(")?o(":"==t.charAt(1)?t.slice(2,-1):t.slice(1,-1)):o(":"==t.charAt(1)?t.slice(2):t.slice(1)))?e.endsWith("(")?{typ:"Pseudo-class-func",val:e.slice(0,-1),chi:[]}:{typ:"Pseudo-class",val:e}:function(e){return 64==e.charCodeAt(0)&&o(e.slice(1))}(e)?{typ:"At-rule",val:e.slice(1)}:function(e){return e.endsWith("(")&&o(e.slice(0,-1))}(e)?{typ:"url"==(e=e.slice(0,-1))?"UrlFunc":"Func",val:e,chi:[]}:l(e)?{typ:"Number",val:e}:function(e){let t=0;for(;t++<e.length;){if(a(e.charCodeAt(e.length-t))){t--;break}if(3==t)break}if(0==t||t>3)return!1;const r=e.slice(0,-t);return r.length>0&&n(e.charCodeAt(e.length-t))&&l(r)}(e)?function(e){let t=0;for(;t++<e.length;){if(a(e.charCodeAt(e.length-t))){t--;break}if(3==t)break}const n={typ:"Dimension",val:e.slice(0,-t),unit:e.slice(-t)};return function(e){return"unit"in e&&["rad","turn","deg","grad"].includes(e.unit.toLowerCase())}(n)?n.typ="Angle":r(n)?n.typ="Length":function(e){return"unit"in e&&["ms","s"].includes(e.unit.toLowerCase())}(n)?n.typ="Time":function(e){return"unit"in e&&["dpi","dpcm","dppx","x"].includes(e.unit.toLowerCase())}(n)?(n.typ="Resolution","dppx"==n.unit&&(n.unit="x")):function(e){return"unit"in e&&["hz","khz"].includes(e.unit.toLowerCase())}(n)&&(n.typ="Frequency"),n}(e):function(e){return e.endsWith("%")&&l(e.slice(0,-1))}(e)?{typ:"Perc",val:e.slice(0,-1)}:"currentColor"==e?{typ:"Color",val:e,kin:"lit"}:o(e)?{typ:"Iden",val:e}:"#"==e.charAt(0)&&function(e){return"#"==e.charAt(0)&&(o(e.charAt(1)),!0)}(e)?{typ:"Hash",val:e}:"\"'".includes(e.charAt(0))?{typ:"Unclosed-string",val:e}:{typ:"Literal",val:e};var t}function P(e,t){let r,n=1;for(;;)if(r=z(),"\\"!=r){if("/"==r&&"*"==W()){for(z();r=z(),""!==r;)if("*"==r&&"/"==W()){z();break}}else r==t?n--:r==e&&n++;if(""===r||0==n)break}else if(""===z())break}function L(e){let t,r=0;for(r=0;r<e.length;r++)if("Comment"==e[r].typ){A.chi.push(e[r]);t={sta:x.get(e[r]),src:g},s.location&&(e[r].loc=t)}else if("Whitespace"!=e[r].typ)break;const n=(e=e.slice(r)).pop();for(;["Whitespace","Bad-string","Bad-comment"].includes(e[e.length-1]?.typ);)e.pop();if(0==e.length)return null;if("At-rule"==e[0]?.typ){const r=e.shift(),a=x.get(r);if("charset"==r.val&&a.ind>0)return i.push({action:"drop",message:"invalid @charset",location:{src:g,...a}}),null;for(;["Whitespace"].includes(e[0]?.typ);)e.shift();if("import"==r.val){if(A.chi.length>0){let e=A.chi.length;for(;e--;){const t=A.chi[e].typ;if("Comment"==t)continue;if("AtRule"!=t)return i.push({action:"drop",message:"invalid @import",location:{src:g,...a}}),null;const r=A.chi[e].nam;if("charset"!=r&&"import"!=r&&"layer"!=r)return i.push({action:"drop",message:"invalid @import",location:{src:g,...a}}),null;break}}if("String"!=e[0]?.typ&&"UrlFunc"!=e[0]?.typ)return i.push({action:"drop",message:"invalid @import",location:{src:g,...a}}),null;if("UrlFunc"==e[0].typ&&"Url-token"!=e[1]?.typ&&"String"!=e[1]?.typ)return i.push({action:"drop",message:"invalid @import",location:{src:g,...a}}),null}"import"==r.val&&"UrlFunc"==e[0].typ&&"Url-token"==e[1].typ&&(e.shift(),e[0].typ="String",e[0].val=`"${e[0].val}"`);const o={typ:"AtRule",nam:k(r,{removeComments:!0}),val:e.reduce(((e,t,r,n)=>"Whitespace"!=t.typ||"Start-parens"!=n[r+1]?.typ&&"End-parens"!=n[r-1]?.typ&&"Func"!=n[r-1]?.typ?e+k(t,{removeComments:!0}):e),"")};if("import"==o.nam&&s.processImport){let t=e["UrlFunc"==e[0].typ?1:0];("String"==t.typ?t.val.slice(1,-1):t.val).startsWith("data:")}return"Block-start"==n.typ&&(o.chi=[]),t={sta:a,src:g},s.location&&(o.loc=t),A.chi.push(o),"Block-start"==n.typ?o:null}if("Block-start"==n.typ){const r=x.get(e[0]);if("Rule"==A.typ&&"Iden"==e[0]?.typ)return i.push({action:"drop",message:"invalid nesting rule",location:{src:g,...r}}),null;const n=O(e,{compress:s.compress}).map((e=>k(e,{compress:!0}))),a=[...new Set(n.reduce(((e,t)=>(","==t?e.push(""):e[e.length-1]+=t,e)),[""]))],o={typ:"Rule",sel:a.join(","),chi:[]};return Object.defineProperty(o,"raw",{enumerable:!1,get:()=>a}),t={sta:r,src:g},s.location&&(o.loc=t),A.chi.push(o),o}{let r=null,n=null;for(let t=0;t<e.length;t++)"Comment"!=e[t].typ&&"Colon"==e[t].typ&&(r=e.slice(0,t),n=O(e.slice(t+1),{parseColor:!0}));null==r&&(r=e);const a=x.get(r[0]);if(r.length>0)for(let e=1;e<r.length;e++)if("Whitespace"!=r[e].typ&&"Comment"!=r[e].typ)return i.push({action:"drop",message:"invalid declaration",location:{src:g,...a}}),null;if(null==n)return i.push({action:"drop",message:"invalid declaration",location:{src:g,...a}}),null;if(0==n.length)return i.push({action:"drop",message:"invalid declaration",location:{src:g,...a}}),null;const o={typ:"Declaration",nam:k(r.shift(),{removeComments:!0}),val:n};for(;"Whitespace"==o.val[0]?.typ;)o.val.shift();return 0==o.val.length?(i.push({action:"drop",message:"invalid declaration",location:{src:g,...a}}),null):(t={sta:a,src:g},s.location&&(o.loc=t),A.chi.push(o),null)}}function W(t=1){return 1==t?e.charAt(h+1):e.slice(h+1,h+t+1)}function $(t=1){return 1==t?0==h?"":e.charAt(h-1):e.slice(h-1-t,h-1)}function z(t=1){let r="";for(;t-- >0&&h<C;){const t=e.charCodeAt(++h);if(isNaN(t))return r;r+=e.charAt(h),c(t)?(f++,u=0):u++}return r}function F(e){p.push(e),x.set(e,{...b}),b.ind=h,b.lin=f,b.col=0==u?1:u}function D(){let t=0;for(;d(e.charAt(t+h+1).charCodeAt(0));)t++;return z(t),t}function I(e){const t=e;let r,n=!1;for(w.length>0&&(F(S(w)),w=""),w+=e;h<C;){if(r=W(),h>=C){F({typ:n?"Bad-string":"Unclosed-string",val:w});break}if("\\"!=r){if(r==t){w+=r,F({typ:n?"Bad-string":"String",val:w}),z(),w="";break}if(c(r.charCodeAt(0))&&(n=!0),n&&";"==r){F({typ:"Bad-string",val:w}),w="";break}w+=r,z()}else{if(h>=C){F(S(w));break}w+=z(2)}}}for(s.location&&(y.loc={sta:{ind:h,lin:f,col:u},src:""});h<C;){if(v=z(),h>=C){w.length>0&&(F(S(w)),w="");break}if(d(v.charCodeAt(0))){for(w.length>0&&(F(S(w)),w="");h<C&&(v=z(),!(h>=C))&&d(v.charCodeAt(0)););if(F({typ:"Whitespace"}),w="",h>=C)break}switch(v){case"/":if(w.length>0&&"Whitespace"==p.at(-1)?.typ&&(F(S(w)),w="","*"!=W())){F(S(v));break}if(w+=v,"*"==W())for(w+="*",z();h<C;){if(v=z(),h>=C){F({typ:"Bad-comment",val:w});break}if("\\"!=v)if("*"==v){if(w+=v,v=z(),h>=C){F({typ:"Bad-comment",val:w});break}if(w+=v,"/"==v){F({typ:"Comment",val:w}),w="";break}}else w+=v;else{if(w+=v,v=z(),h>=C){F({typ:"Bad-comment",val:w});break}w+=v}}break;case"<":if(w.length>0&&(F(S(w)),w=""),w+=v,v=z(),h>=C)break;if("!--"==W(3))for(;h<C&&(v=z(),!(h>=C));)if(w+=v,">"==v&&"--"==$(2)){F({typ:"CDOCOMM",val:w}),w="";break}h>=C&&(F({typ:"BADCDO",val:w}),w="");break;case"\\":if(v=z(),h+1>=C){F(S(w)),w="";break}w+=v;break;case'"':case"'":I(v);break;case"~":case"|":if(w.length>0&&(F(S(w)),w=""),w+=v,v=z(),h>=C){F(S(w)),w="";break}if("="==v){w+=v,F({typ:"~"==w[0]?"Includes":"Dash-matches",val:w}),w="";break}F(S(w)),w=v;break;case">":"Whitespace"==p[p.length-1]?.typ&&p.pop(),F({typ:"Gt"}),D();break;case":":case",":case"=":if(w.length>0&&(F(S(w)),w=""),":"==v&&":"==W()){w+=v+z();break}for(F(S(v)),w="";d(W().charCodeAt(0));)z();break;case")":w.length>0&&(F(S(w)),w=""),F({typ:"End-parens"});break;case"(":if(0==w.length)F({typ:"Start-parens"});else{w+=v,F(S(w)),w="";if("UrlFunc"==p[p.length-1].typ){let e="";for(v=W();d(v.charCodeAt(0));)e+=v;if(e.length>0&&z(e.length),v=W(),'"'==v||"'"==v){I(z());let e=p[p.length-1];["String","Literal"].includes(e.typ)&&/^(["']?)[a-zA-Z0-9_/-][a-zA-Z0-9_/:.-]+(\1)$/.test(e.val)&&"String"==e.typ&&(e.val=e.val.slice(1,-1));break}for(w="";;){let t=v.charCodeAt(0);if(null==t){F({typ:"Bad-url-token",val:w});break}if(41==t||null==t){0==w.length?F({typ:"Bad-url-token",val:""}):F({typ:"Url-token",val:w}),null!=t&&F(S(z()));break}if(d(t)){for(e=z();v=W(),t=v.charCodeAt(0),d(t);)e+=v;if(null==t||41==t)continue;for(w+=z(e.length);;){if(v=W(),t=v.charCodeAt(0),null==t||41==t)break;w+=z()}F({typ:"Bad-url-token",val:w})}else w+=z(),v=W()}w=""}}break;case"[":case"]":case"{":case"}":case";":w.length>0&&(F(S(w)),w=""),F(E(v));let e=null;if("{"==v||";"==v)e=L(p),null!=e?(m.push(e),A=e):"{"==v&&P("{","}"),p.length=0,x.clear();else if("}"==v){L(p);const e=m.pop();A=m[m.length-1]||y,s.removeEmpty&&null!=e&&0==e.chi.length&&A.chi[A.chi.length-1]==e?A.chi.pop():null!=e&&e!=y&&s.compress&&(M(e)?j(e):q(e,s)),p.length=0,x.clear(),w=""}break;case"!":w.length>0&&(F(S(w)),w="");if("important"==W(9)){"Whitespace"==p[p.length-1]?.typ&&p.pop(),F({typ:"Important"}),z(9),w="";break}w="!";break;default:w+=v}}if(w.length>0&&F(S(w)),s.compress){for(;m.length>0;){const e=m.pop();M(e)?j(e,s):q(e,s)}y.chi.length>0&&q(y,s)}return{ast:y,errors:i}}function O(e,t={}){for(let r=0;r<e.length;r++){const a=e[r];if("Whitespace"==a.typ&&(0==r||r+1==e.length||["Comma","Start-parens"].includes(e[r+1].typ)||r>0&&D.includes(e[r-1].typ)))e.splice(r--,1);else{if("Colon"==a.typ){const t=e[r+1]?.typ;if(null!=t&&("Func"==t?(e[r+1].val=":"+e[r+1].val,e[r+1].typ="Pseudo-class-func"):"Iden"==t&&(e[r+1].val=":"+e[r+1].val,e[r+1].typ="Pseudo-class"),"Func"==t||"Iden"==t)){e.splice(r,1),r--;continue}}if("Attr-start"!=a.typ){if(D.includes(a.typ)){let n=1,i=r;for(;++i<e.length;){if("Colon"==e[i].typ){const t=e[i+1]?.typ;if(null!=t&&("Iden"==t?(e[i+1].typ="Pseudo-class",e[i+1].val=":"+e[i+1].val):"Func"==t&&(e[i+1].typ="Pseudo-class-func",e[i+1].val=":"+e[i+1].val),"Func"==t||"Iden"==t)){e.splice(i,1),i--;continue}}if(D.includes(e[i].typ)?n++:"End-parens"==e[i].typ&&n--,0==n)break}if(a.chi=e.splice(r+1,i-r),"End-parens"==a.chi.at(-1)?.typ&&a.chi.pop(),t.parseColor&&["rgb","rgba","hsl","hsla","hwb","device-cmyk"].includes(a.val)){let e=!0;for(const t of a.chi)if("Func"==t.typ&&"var"==t.val){e=!1;break}if(!e)continue;a.typ="Color",a.kin=a.val;let t=a.chi.length;for(;t-- >0;)"Literal"==a.chi[t].typ&&("Whitespace"==a.chi[t+1]?.typ&&a.chi.splice(t+1,1),"Whitespace"==a.chi[t-1]?.typ&&(a.chi.splice(t-1,1),t--))}else if("UrlFunc"==a.typ&&"String"==a.chi[0]?.typ){const e=a.chi[0].val.slice(1,-1);/^[/%.a-zA-Z0-9_-]+$/.test(e)&&(a.chi[0].typ="Url-token",a.chi[0].val=e)}if(a.chi.length>0&&(O(a.chi,t),"Pseudo-class-func"==a.typ&&":is"==a.val&&t.compress)){1!=a.chi.filter((e=>"Comment"!=e.typ)).length&&(0!=r||"Comma"!=e[r+1]?.typ&&e.length!=r+1)&&("Comma"!=e[r-1]?.typ||"Comma"!=e[r+1]?.typ&&e.length!=r+1)||(e.splice(r,1,...a.chi),r=Math.max(0,r-a.chi.length))}}else if(t.parseColor){if("Iden"==a.typ){const e=a.val.toLowerCase();null!=u[e]&&Object.assign(a,{typ:"Color",val:u[e].length<e.length?u[e]:e,kin:"hex"});continue}if("Hash"==a.typ&&s(a.val)){a.typ="Color",a.kin="hex";continue}}}else{let i=r,l=1;for(;++i<e.length&&("Attr-end"==e[i].typ?l--:"Attr-start"==e[i].typ&&l++,0!=l););Object.assign(a,{typ:"Attr",chi:e.splice(r+1,i-r)}),"Attr-end"==a.chi.at(-1).typ&&(a.chi.pop(),a.chi.length>1&&O(a.chi,t),a.chi.forEach((e=>{if("String"==e.typ){const t=e.val.slice(1,-1);("-"!=t.charAt(0)||"-"==t.charAt(0)&&n(t.charCodeAt(1)))&&o(t)&&Object.assign(e,{typ:"Iden",val:t})}})))}}}return e}function E(e){if(";"==e)return{typ:"Semi-colon"};if("{"==e)return{typ:"Block-start"};if("}"==e)return{typ:"Block-end"};if("["==e)return{typ:"Attr-start"};if("]"==e)return{typ:"Attr-end"};throw new Error(`unhandled token: '${e}'`)}e.deduplicate=q,e.deduplicateRule=j,e.hasDeclaration=M,e.parse=I,e.render=b,e.renderToken=k,e.transform=function(e,t={}){t={compress:!0,removeEmpty:!0,...t};const r=performance.now(),n=I(e,t);if(null==n)return null;const a=performance.now(),i=b(n.ast,t),o=performance.now();return{...n,...i,performance:{bytesIn:e.length,bytesOut:i.code.length,parse:`${(a-r).toFixed(2)}ms`,render:`${(o-a).toFixed(2)}ms`,total:`${(o-r).toFixed(2)}ms`}}}}));
